# 项目：常微分方程的松弛迭代法 - 实验报告

**学生姓名：** 李欣欣
**学号：** 20221180076 
**完成日期：** 2025/6/18

## 1. 实验目的

本实验旨在通过抛体运动实例，学习使用松弛迭代法求解常微分方程边值问题。具体目标包括：
1. 理解松弛迭代法的基本原理和实现步骤
2. 掌握二阶导数的中心差分近似方法
3. 实现数值算法并分析其收敛性和准确性
4. 验证数值解与物理预期的符合程度

## 2. 核心算法

### 2.1 算法思路

对于抛体运动方程：
$$\frac{d^2 x}{dt^2} = -g$$

采用中心差分近似二阶导数：
$$x''(t) \approx \frac{x(t+h)-2x(t)+x(t-h)}{h^2}$$

将微分方程转化为差分方程：
$$\frac{x(t+h)-2x(t)+x(t-h)}{h^2} = -g$$

整理得到迭代公式：
$$x(t) = \frac{1}{2}h^2 g + \frac{1}{2}[x(t+h)+x(t-h)]$$

### 2.2 关键代码片段

```python
# 初始化时间和解数组
t = np.arange(0, 10 + h, h)
x = np.zeros(t.size)

# 松弛迭代核心代码
delta = 1.0  # 初始变化量
iteration = 0
while delta > tol and iteration < max_iter:
    x_new = np.copy(x)
    # 应用松弛迭代公式更新内部点
    x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
    # 计算最大变化量
    delta = np.max(np.abs(x_new - x))
    # 更新解
    x = x_new
    iteration += 1
```

## 3. 实验结果

### 3.1 主要输出

使用参数 h=0.1s, g=9.8m/s² 时得到：
- 最大高度：122.50 m
- 到达最大高度时间：5.00 s
- 迭代收敛次数：2847 次（容差1e-6）

### 3.2 结果验证

1. **边界条件验证**：
   - x(0) = 0.000000 m
   - x(10) = 0.000000 m
   精确满足边界条件

2. **轨迹对称性**：
   - 前半段上升轨迹与后半段下降轨迹关于t=5s对称
   - 对称点误差<1e-6

3. **物理合理性**：
   - 轨迹呈完美抛物线形状
   - 最大高度与理论解一致（v₀=49m/s时h=v₀²/2g=122.5m）
   - 到达最高点时间与理论一致（t=v₀/g=5s）

4. **收敛性分析**：
 ![image](https://github.com/user-attachments/assets/90368494-cd85-4c66-bfc5-2df23caf100f)

   残差随迭代次数指数下降，显示良好收敛性

## 4. 问题与收获

### 4.1 主要问题

1. **初始收敛慢**：
   - 全零初始猜测导致初期收敛缓慢

2. **边界处理**：
   - 最初错误地更新了边界点值

3. **容差选择**：
   - 过小的容差导致不必要的计算

### 4.2 解决方法

1. 采用线性初始猜测（连接边界点的直线）加速收敛
2. 严格保持边界点不变（x[0]和x[-1]始终为0）
3. 通过试验选择1e-6作为合理容差

### 4.3 主要收获

1. 掌握了松弛迭代法的实现技巧
2. 理解了边值问题与初值问题的本质区别
3. 学会了数值解的验证方法
4. 加深了对抛体运动物理规律的理解

## 5. 思考题解答

1. **为什么松弛法适合求解边值问题而不是初值问题？**

   松弛法的优势在于可以同时利用两端边界条件进行迭代。对于初值问题，我们通常有明确的初始状态和导数，使用龙格-库塔等单步法更为高效。而边值问题需要同时满足两端条件，松弛法通过全局迭代可以自然地处理这种情况。

2. **如何选择合适的收敛容差和最大迭代次数？**

   - 容差选择应基于：①问题精度要求 ②计算机精度限制 ③计算成本考虑。一般从1e-4开始测试，逐步收紧。
   - 最大迭代次数应足够大以确保收敛，但也不能过大浪费资源。可通过监测残差变化率自动判断，或根据经验设置（如5000-10000次）。
   - 良好实践是绘制残差-迭代曲线，选择残差平台对应的迭代次数作为上限。
