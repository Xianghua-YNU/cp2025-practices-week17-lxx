# 项目：有限厚平行板电容器电荷分布分析 - 实验报告

**学生姓名：** 李欣欣
**学号：** 20221180076 
**完成日期：** 2025/6/18

## 1. 实验目的
本实验通过数值方法研究有限厚度平行板电容器的电势分布和电荷密度分布，掌握用SOR迭代法求解拉普拉斯方程的技术，验证导体静电平衡的基本性质。

## 2. 核心算法

### 2.1 算法思路
1. 采用逐次超松弛迭代法(SOR)求解二维拉普拉斯方程∇²φ=0
2. 通过中心差分近似计算二阶导数，在非导体区域迭代更新电势
3. 导体区域保持固定电势（上板+100V，下板-100V）
4. 边界设置为Dirichlet边界条件（四周接地）
5. 收敛判据为相邻迭代间最大电势差<1e-6

### 2.2 关键代码片段
```python
# SOR迭代核心代码
for iteration in range(max_iter):
    max_diff = 0.0
    for i in range(1, ny-1):
        for j in range(1, nx-1):
            if conductor_mask[i, j]:  # 跳过导体区域
                continue
            old_val = potential[i, j]
            new_val = (1-omega)*old_val + omega*0.25*(
                potential[i+1,j] + potential[i-1,j] + 
                potential[i,j+1] + potential[i,j-1])
            potential[i,j] = new_val
            max_diff = max(max_diff, abs(new_val - old_val))
    if max_diff < tolerance:
        break
```

## 3. 实验结果

### 3.1 主要输出
- 收敛迭代次数：约850次（ω=1.8）
- 电势范围：-100V ~ +100V（差值为200V）
- 电荷分布特征：
  - 最大电荷密度：3.2e-3 C/m²（出现在导体边缘）
  - 总电荷量：2.1e-16 C（接近零）
- 计算时间：0.45秒（100×80网格）
![image](https://github.com/user-attachments/assets/b6696c8e-bab1-4f5f-9a93-0f2077206f45)

### 3.2 结果验证
1. **边界验证**：四周电势严格保持0V（误差<1e-10）
2. **导体验证**：内部电势恒定，电荷密度为零
3. **物理合理性**：
   - 电场线垂直于导体表面
   - 边缘处电场强度最大
   - 满足电荷守恒定律

## 4. 问题与收获

### 4.1 主要问题
1. 初始设置导体位置时出现不对称分布
2. 电荷密度计算在边界处出现异常峰值

### 4.2 解决方法
1. 采用几何中心定位法精确计算导体位置：
   ```python
   y_mid = ny // 2
   upper_start = y_mid - plate_separation//2 - plate_thickness
   ```
2. 对边界点采用单侧差分近似，并排除导体区域

### 4.3 主要收获
1. 掌握了SOR迭代法的实现与优化技巧
2. 理解了有限差分法求解偏微分方程的原理
3. 加深了对导体静电平衡条件的认识
4. 学会了通过可视化验证数值结果的物理合理性
5. 掌握了科学计算中精度与效率的平衡方法

## 5. 思考题

### 5.1 松弛因子影响分析
| ω值 | 收敛迭代次数 | 收敛速度 |
|-----|-------------|---------|
| 1.0 | 3200        | 基准    |
| 1.5 | 1200        | 2.7×    |
| 1.8 | 850         | 3.8×    |
| 1.9 | 700         | 4.6×    |

最优ω≈1.9时收敛最快，因超松弛修正了迭代方向。但ω>1.95可能导致发散。

### 5.2 有限厚度效应
| 特征          | 有限厚度板          | 理想薄板          |
|---------------|---------------------|-------------------|
| 边缘电场      | 显著增强（3.2倍）   | 理论无限大        |
| 中心电场      | 均匀分布            | 完全均匀          |
| 电荷分布      | 边缘集中            | 表面均匀          |
| 电容计算误差  | 需考虑边缘效应      | 公式直接适用      |

### 5.3 数值精度讨论
网格分辨率影响：
- 100×80网格：相对误差约0.5%
- 200×160网格：误差降至0.1%
- 400×320网格：误差0.05%但计算时间增至8秒

优化策略：
1. 在边缘区域使用局部网格加密
2. 采用自适应步长算法
3. 对中心区域可适当降低分辨率
``` 

注：本报告中的实验数据基于以下参数：
- 网格大小：100×80
- 板厚：5个网格单位
- 板间距：30个网格单位
- 松弛因子ω=1.8
- 收敛容差1e-6
